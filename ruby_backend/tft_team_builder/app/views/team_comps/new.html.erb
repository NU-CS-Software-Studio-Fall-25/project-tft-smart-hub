<%# app/views/team_comps/new.html.erb %>

<%# data-controller="builder" links this div and its child elements to our JS controller %>
<div data-controller="builder">
  <h1>Create New Team Composition</h1>

  <%= form_with(model: @team_comp) do |form| %>
    <div class="mb-3">
      <%= form.label :name, class: "form-label" %>
      <%= form.text_field :name, class: "form-control" %>
    </div>

    <div class="mb-3">
      <%= form.label :description, class: "form-label" %>
      <%= form.text_area :description, class: "form-control", rows: 3 %>
    </div>

    <%# This is a hidden input field for storing and submitting the final list of champion names %>
    <%= form.hidden_field :champions, 'data-builder-target': "hiddenField" %>

    <hr>

    <%# Current lineup display area %>
    <%# We give the span used for counting a new name: "count" %>
    <h3>Current Lineup (<span data-builder-target="count">0</span>)</h3>

    <%# The lineup container name remains "lineup" unchanged %>
    <div class="d-flex flex-wrap gap-2 p-3 border rounded bg-light mb-4 min-vh-25" data-builder-target="lineup">
      <%# Selected champions will appear here %>
    </div>

    <%# Champion selection pool %>
    <h3>Champion Pool</h3>
    <div class="d-flex flex-wrap gap-2 p-3 border rounded">
      <% @champions.each do |champion| %>
        <%#
          - data-builder-target: marks this element
          - data-action: defines the JS method triggered on click
          - data-*: used to store champion data for JS to read
        %>
        <div
          data-builder-target="poolChampion"
          data-action="click->builder#add"
          data-id="<%= champion.id %>"
          data-name="<%= champion.name %>"
          class="text-center" style="cursor: pointer;"
        >
          <%= image_tag champion.image_url, style: "width: 52px; height: 52px;", class: "border rounded" %>
          <div class="small mt-1"><%= champion.name %></div>
        </div>
      <% end %>
    </div>

    <div class="mt-4">
      <%= form.submit "Save Team Composition", class: "btn btn-primary" %>
    </div>
  <% end %>
</div>